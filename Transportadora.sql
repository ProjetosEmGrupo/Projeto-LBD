USE LBDT_G09;

-- -----------------------------------------------------
-- Table TBL_CARGO
-- -----------------------------------------------------
CREATE TABLE TBL_CARGO (
  ID INT NOT NULL identity,
  DESCRICAO VARCHAR(45) NOT NULL,
  PRIMARY KEY (ID));

-- -----------------------------------------------------
-- Table TBL_ENDERECO
-- -----------------------------------------------------
  CREATE TABLE TBL_ENDERECO(
  ID INT PRIMARY KEY IDENTITY,  
  LOGRADOURO VARCHAR(45) NOT NULL,
  COMPLEMENTO VARCHAR(45) NULL,
  CEP CHAR(11) NOT NULL,
  CIDADE VARCHAR(45) NOT NULL,
  UF VARCHAR(2) NOT NULL,
  PAIS VARCHAR(45) NOT NULL);

-- -----------------------------------------------------
-- Table TBL_FUNCIONARIO
-- -----------------------------------------------------
CREATE TABLE TBL_FUNCIONARIO (
  ID INT NOT NULL identity,
  NOME VARCHAR(45) NOT NULL,
  CPF CHAR(14) NOT NULL,
  DATA_NASC DATE NOT NULL,
  DATA_ADM DATE NOT NULL,
  ID_CARGO INT NOT NULL,
  ID_ENDERECO INT NOT NULL,
  PRIMARY KEY (ID),
  CONSTRAINT fk_TBL_FUNCIONARIO_TBL_CARGO1
    FOREIGN KEY (ID_CARGO)
    REFERENCES TBL_CARGO (ID),
	FOREIGN KEY (ID_ENDERECO)
    REFERENCES TBL_ENDERECO(ID));

-- -----------------------------------------------------
-- Table TBL_TIPO_VEICULO
-- -----------------------------------------------------
CREATE TABLE TBL_TIPO_VEICULO (
  ID INT NOT NULL identity,
  TIPO_VEICULO VARCHAR(40) NOT NULL,
  PRIMARY KEY (ID));

-- -----------------------------------------------------
-- Table TBL_FABRICANTE
-- -----------------------------------------------------
CREATE TABLE TBL_FABRICANTE (
  ID INT NOT NULL identity,
  DESCRICAO VARCHAR(45) NOT NULL,
  PRIMARY KEY (ID));

-- -----------------------------------------------------
-- Table TBL_VEICULO
-- -----------------------------------------------------
CREATE TABLE TBL_VEICULO (
  ID INT NOT NULL identity,
  MODELO VARCHAR(45) NOT NULL,
  ANO_FABRICACAO date NOT NULL,
  PLACA CHAR(8) NOT NULL,
  COR VARCHAR(15) NOT NULL,
  SITUACAO INT NULL,
  CIDADE VARCHAR(20) NOT NULL,
  UF CHAR(2) NOT NULL,
  DATA_COMPRA DATE NOT NULL,
  ID_TIPO_VEICULO INT NOT NULL,
  ID_FABRICANTE INT NOT NULL,
  PRIMARY KEY (ID),
  CONSTRAINT fk_TLB_VEICULO_tbl_TIPO_VEICULO1
    FOREIGN KEY (ID_TIPO_VEICULO)
    REFERENCES TBL_TIPO_VEICULO (ID),
  CONSTRAINT fk_TBL_VEICULO_TBL_FABRICANTE1
    FOREIGN KEY (ID_FABRICANTE)
    REFERENCES TBL_FABRICANTE (ID));

-- -----------------------------------------------------
-- Table TBL_FICHA_MEDICA
-- -----------------------------------------------------
CREATE TABLE TBL_FICHA_MEDICA (
  ID INT NOT NULL identity,
  DEFICIENCIA TINYINT NOT NULL,
  DESCRICAO_DEFICIENCIA VARCHAR(45) NULL,
  DOENCAS_CONTAGIOSAS_A TINYINT NOT NULL,
  DESCRICAO_DOENCAS_CONTAGIOSAS_A VARCHAR(45) NULL,
  TIPO_SANGUINEO VARCHAR(3) NOT NULL,
  MEDICACAO_CONTROLADA TINYINT NOT NULL,
  DESCRICAO_MEDICACAO_CONTROLADA VARCHAR(45) NULL,
  ID_FUNCIONARIO INT NOT NULL,
  PRIMARY KEY (ID),
  CONSTRAINT fk_TBL_FICHA_MEDICA_TBL_PESSOA1
    FOREIGN KEY (ID_FUNCIONARIO)
    REFERENCES TBL_FUNCIONARIO (ID));

-- -----------------------------------------------------
-- Table TBL_CLIENTE
-- -----------------------------------------------------
CREATE TABLE TBL_CLIENTE (
  ID INT NOT NULL identity,
  NOME VARCHAR(45) NOT NULL,
  ENDERECO VARCHAR(50) NOT NULL,
  TELEFONE VARCHAR(17) NOT NULL,
  PRIMARY KEY (ID));
 
-- -----------------------------------------------------
-- Table TBL_VIAGEM
-- -----------------------------------------------------
CREATE TABLE TBL_VIAGEM (
  ID INT NOT NULL identity,
  DATA_SAIDA DATE NOT NULL,
  DATA_CHEGADA DATE NULL,
  DISTANCIA VARCHAR(45) NOT NULL,
  FRETE DECIMAL(8,2) NOT NULL,
  RECEBIDO_OBS VARCHAR(45) NULL,
  ID_VEICULO INT NOT NULL,
  ID_CLIENTE_ENVIO INT NOT NULL,
  ID_CLIENTE_DESTINO INT NOT NULL,
  ID_END_ENVIO INT NOT NULL,
  ID_END_DESTINO INT NOT NULL,
  ID_SUPERVISOR INT NOT NULL,
  PRIMARY KEY (ID),
    FOREIGN KEY (ID_VEICULO)
    REFERENCES TBL_VEICULO (ID), 
    FOREIGN KEY (ID_CLIENTE_ENVIO)
    REFERENCES TBL_CLIENTE (ID),
	FOREIGN KEY (ID_CLIENTE_DESTINO)
    REFERENCES TBL_CLIENTE (ID),
    FOREIGN KEY (ID_SUPERVISOR)
    REFERENCES TBL_FUNCIONARIO (ID),
	FOREIGN KEY (ID_END_ENVIO)
    REFERENCES TBL_ENDERECO (ID),
	FOREIGN KEY (ID_END_DESTINO)
    REFERENCES TBL_ENDERECO (ID));

-- -----------------------------------------------------
-- Table TBL_VIA
-- -----------------------------------------------------
CREATE TABLE TBL_VIA (
  ID INT NOT NULL IDENTITY,
  DESCRICAO VARCHAR(45) NOT NULL,
  PRIMARY KEY (ID));

-- -----------------------------------------------------
-- Table TBL_PEDAGIO
-- -----------------------------------------------------
CREATE TABLE TBL_PEDAGIO (
  ID_PEDAGIO INT NOT NULL identity,
  ID_VIA INT NOT NULL,
  DESCRICAO VARCHAR(45) NOT NULL,
  PRIMARY KEY (ID_PEDAGIO),
  CONSTRAINT fk_tbl_PEDAGIO_tbl_VIA1
    FOREIGN KEY (ID_VIA)
    REFERENCES TBL_VIA (ID));

-- -----------------------------------------------------
-- Table TBL_VALOR_PEDAGIO
-- -----------------------------------------------------
CREATE TABLE TBL_VALOR_PEDAGIO (
  ID_PEDAGIO INT NOT NULL,
  ID_TIPO_VEICULO INT NOT NULL,
  VALOR_PEDAGIO DECIMAL(5,2) NOT NULL,
  PRIMARY KEY (ID_PEDAGIO, ID_TIPO_VEICULO),
  CONSTRAINT fk_tbl_VALOR_PEDAGIO_tbl_PEDAGIO1
    FOREIGN KEY (ID_PEDAGIO)
    REFERENCES TBL_PEDAGIO (ID_PEDAGIO),
  CONSTRAINT fk_tbl_VALOR_PEDAGIO_tbl_TIPO_VEICULO1
    FOREIGN KEY (ID_TIPO_VEICULO)
    REFERENCES TBL_TIPO_VEICULO (ID));

-- -----------------------------------------------------
-- Table TBL_TRAJETO
-- -----------------------------------------------------
CREATE TABLE TBL_TRAJETO (
  ID_VIAGEM INT NOT NULL,
  ID_VIA INT NOT NULL,
  PRIMARY KEY (ID_VIAGEM, ID_VIA),
  CONSTRAINT fk_TBL_TRAJETO_TBL_VIAGEM1
    FOREIGN KEY (ID_VIAGEM)
    REFERENCES TBL_VIAGEM (ID),
  CONSTRAINT fk_TBL_TRAJETO_tbl_VIA1
    FOREIGN KEY (ID_VIA)
    REFERENCES TBL_VIA (ID));

-- -----------------------------------------------------
-- Table TBL_MOTORISTA_VIAGEM
-- -----------------------------------------------------
CREATE TABLE TBL_MOTORISTA_VIAGEM (
  ID_FUNCIONARIO INT NOT NULL,
  ID_VIAGEM INT NOT NULL,
  PRIMARY KEY (ID_FUNCIONARIO, ID_VIAGEM),
    FOREIGN KEY (ID_FUNCIONARIO)
    REFERENCES TBL_FUNCIONARIO (ID),
    FOREIGN KEY (ID_VIAGEM)
    REFERENCES TBL_VIAGEM (ID));

-- -----------------------------------------------------
-- Table TBL_TIPO_MERCADORIA
-- -----------------------------------------------------
CREATE TABLE TBL_TIPO_MERCADORIA (
  ID INT NOT NULL identity,
  DESCRICAO VARCHAR(45) NOT NULL,
  PRIMARY KEY (ID));

-- -----------------------------------------------------
-- Table TBL_FRETE
-- -----------------------------------------------------
CREATE TABLE TBL_FRETE (
  ID INT NOT NULL identity,
  PRECO_BASE DECIMAL(8,2) NOT NULL,
  ID_TIPO_VEICULO INT NOT NULL,
  ID_TIPO_MERCADORIA INT NOT NULL,
  PRIMARY KEY (ID),
  CONSTRAINT fk_TBL_FRETE_TBL_TIPO_VEICULO1
    FOREIGN KEY (ID_TIPO_VEICULO)
    REFERENCES TBL_TIPO_VEICULO (ID),
  CONSTRAINT fk_TBL_FRETE_TBL_TIPO_MERCADORIA1
    FOREIGN KEY (ID_TIPO_MERCADORIA)
    REFERENCES TBL_TIPO_MERCADORIA (ID));

-- -----------------------------------------------------
-- Table TBL_TRANSACOES
-- -----------------------------------------------------
CREATE TABLE TBL_TRANSACOES (
  ID_VEICULO INT NOT NULL,
  SEQ INT NOT NULL identity,
  PRECO DECIMAL(10,2) NOT NULL,
  TIPO VARCHAR(45) NOT NULL,
  DATA_TRANS DATE NOT NULL,
  PRIMARY KEY (ID_VEICULO, SEQ),
  CONSTRAINT fk_TBL_TRANSACOES_TBL_VEICULO1
    FOREIGN KEY (ID_VEICULO)
    REFERENCES TBL_VEICULO (ID));

-- -----------------------------------------------------
-- Table TBL_MERCADORIA
-- -----------------------------------------------------
CREATE TABLE TBL_MERCADORIA (
  ID INT NOT NULL identity,
  DESCRICAO VARCHAR(45) NOT NULL,
  QTD INT NOT NULL,
  ID_TIPO_MERCADORIA INT NOT NULL,
  ID_VIAGEM INT NOT NULL,
  PRIMARY KEY (ID),
  CONSTRAINT fk_TBL_MERCADORIA_TBL_TIPO_MERCADORIA1
    FOREIGN KEY (ID_TIPO_MERCADORIA)
    REFERENCES TBL_TIPO_MERCADORIA (ID),
  CONSTRAINT fk_TBL_MERCADORIA_TBL_VIAGEM1
    FOREIGN KEY (ID_VIAGEM)
    REFERENCES TBL_VIAGEM (ID));

-- -----------------------------------------------------
-- Table TBL_DIARIO_BORDO
-- -----------------------------------------------------
CREATE TABLE TBL_DIARIO_BORDO (
  TBL_VIAGEM_ID INT NOT NULL,
  SEQ INT NOT NULL identity,
  DESCRICAO VARCHAR(45) NOT NULL,
  PRECO DECIMAL(8,2) NULL,
  DATA_INICIO DATETIME NULL,
  DATA_FIM DATETIME NULL,
  ID_MOTORISTA_ATUAL INT NOT NULL,
  PRIMARY KEY (TBL_VIAGEM_ID, SEQ),
  CONSTRAINT fk_TBL_DIARIO_BORDO_TBL_VIAGEM1
    FOREIGN KEY (TBL_VIAGEM_ID)
    REFERENCES TBL_VIAGEM (ID),
  CONSTRAINT fk_TBL_DIARIO_BORDO_TBL_FUNCIONARIO1
    FOREIGN KEY (ID_MOTORISTA_ATUAL)
    REFERENCES TBL_FUNCIONARIO (ID));

-- -----------------------------------------------------
-- Table TBL_OFICINA
-- -----------------------------------------------------
CREATE TABLE  TBL_OFICINA (
  ID INT NOT NULL,
  NOME VARCHAR(45) NOT NULL,
  CNPJ VARCHAR(18) NOT NULL,
  ID_ENDERECO INT NOT NULL,
  TELEFONE VARCHAR(18) NOT NULL,
  PRIMARY KEY (ID),
  FOREIGN KEY (ID_ENDERECO)
   REFERENCES TBL_ENDERECO (ID));

-- -----------------------------------------------------
-- Table TBL_MECANICO
-- -----------------------------------------------------
CREATE TABLE TBL_MECANICO (
  ID INT NOT NULL identity,
  NOME VARCHAR(45) NOT NULL,
  CPF CHAR(14) NOT NULL,
  DATA_NASC DATE NOT NULL,
  ID_OFICINA INT NOT NULL,
  ID_ENDERECO INT NOT NULL,
  PRIMARY KEY (ID),
  CONSTRAINT fk_TBL_MECANICO_TBL_OFICINA1
    FOREIGN KEY (ID_OFICINA)
    REFERENCES TBL_OFICINA (ID),
	FOREIGN KEY (ID_ENDERECO)
    REFERENCES TBL_ENDERECO (ID));

	-- -----------------------------------------------------
-- Table TBL_MANUTENCAO
-- -----------------------------------------------------
CREATE TABLE TBL_MANUTENCAO (
  ID INT NOT NULL identity,
  DESCRICAO VARCHAR(45) NOT NULL,
  PRECO DECIMAL(8,2) NOT NULL,
  DATA_ENTRADA DATE NOT NULL,
  DATA_SAIDA DATE NULL,
  ID_VEICULO INT NOT NULL,
  ID_OFICINA INT NOT NULL,
  ID_MECANICO INT NOT NULL,
  PRIMARY KEY (ID),
  FOREIGN KEY (ID_MECANICO)
    REFERENCES TBL_MECANICO (ID),
    FOREIGN KEY (ID_VEICULO)
    REFERENCES TBL_VEICULO (ID),
    FOREIGN KEY (ID_OFICINA)
    REFERENCES TBL_OFICINA (ID));

	INSERT INTO TBL_CARGO (DESCRICAO)
	VALUES 
	('Motorista'),
	('Supervisor');

	INSERT INTO TBL_FABRICANTE (DESCRICAO)
	VALUES
	('Mercedes-Benz'),
	('Scania'),
	('Volvo'),
	('Ford'),
	('Volkswagen'),
	('Iveco');

	INSERT INTO TBL_CLIENTE (NOME, ENDERECO, TELEFONE)
	VALUES
	('FERRAGENS ZEZINHO', 'RUA DAS RUAS' , '+55(11)4002-8922'),
	('HORTIFRUTI ZEZINHO', 'RUA DAS FADAS','+55 (12)4002-8922'),
	('GRÃOS ZEZINHO', 'RUA DOS GNOMOS' , '+55 (13)4002-8922'),
	('BATERIAS ZEZINHO', 'RUA DAS BRUXAS' , '+55 (14)4002-8922'),
	('AUTO-PEÇAS ZEZINHO', 'RUA DOS ELFOS' , '+55 (15)4002-8922'),
	('PARAFUSOS ZEZINHO', 'RUA DOS ORCS' , '+55 (16)4002-8922'),
	('FRIGORIFICO ZEZINHO', 'AVENIDA DAS RUAS' , '+55 (17)4002-8922'),
	('FERRAGENS BETINHO', 'AVENIDA DAS FADAS' , '+55 (18)4002-8922'),
	('HORTIFRUTI BETINHO', 'AVENIDA DOS GNOMOS' , '+55 (19)4002-8922'),
	('GRÃOS BETINHO', 'AVENIDA DAS BRUXAS' , '+55 (20)4002-8922'),
	('BATERIAS BETINHO', 'AVENIDA DOS ELFOS' , '+55 (21)4002-8922'),
	('FRIGORIFICO BETIINHO', 'AVENIDA DOS ORCS' , '+55 (22)4002-8922');

	INSERT INTO TBL_TIPO_MERCADORIA (DESCRICAO)
	VALUES
	('NORMAL'),
	('GRANEL'),
	('NEOGRANEL'),
	('FRIGORIFICADA'),
	('PERIGOSA');

	INSERT INTO TBL_TIPO_VEICULO (TIPO_VEICULO)
	VALUES
	('VAN'),--1
	('VUC'),--2
	('TOCO'),--3
	('TRUCK'),--4
	('CAVALO MECÂNICO'),--5
	('CAVALO MECÂNICO TRUCADO'),--5
	('BITREM'),--6
	('RODOTREM'),--7
	('GUINCHO');--8

	INSERT INTO TBL_FRETE (PRECO_BASE, ID_TIPO_VEICULO, ID_TIPO_MERCADORIA)
	VALUES
	(2.3, 1, 1), (2.5, 2, 1), (2.7, 3, 1), (2.9, 4, 1), (3.1, 5, 1), (3.3, 6, 1), (3.5, 7, 1), (4.5, 8, 1),
	(2.5, 1, 2), (2.7, 2, 2), (2.9, 3, 2), (3.1, 4, 2), (3.3, 5, 2), (3.5, 6, 2), (3.7, 7, 2),
	(2.7, 1, 3), (2.9, 2, 3), (3.1, 3, 3), (3.3, 4, 3), (3.5, 5, 3), (3.7, 6, 3), (3.9, 7, 3),
	(2.9, 1, 4), (3.1, 2, 4), (3.3, 3, 4), (3.5, 4, 4), (3.7, 5, 4), (3.9, 6, 4), (4.1, 7, 4),
	(3.1, 1, 5), (3.3, 2, 5), (3.5, 3, 5), (3.7, 4, 5), (3.9, 5, 5), (4.1, 6, 5), (4.3, 7, 5);	

	INSERT INTO TBL_VIA (DESCRICAO)
	VALUES
    ('BR-010'), ('BR-020'), ('BR-030'), ('BR-040'), ('BR-050'), ('BR-060'), ('BR-070'), ('BR-080'),
    ('BR-101'), ('BR-104'), ('BR-110'), ('BR-116'), ('BR-120'), ('BR-122'), ('BR-135'), ('BR-146'),
    ('BR-153'), ('BR-154'), ('BR-155'), ('BR-156'), ('BR-158'), ('BR-163'), ('BR-174'), ('BR-210'),
    ('BR-222'), ('BR-226'), ('BR-230'), ('BR-232'), ('BR-235'), ('BR-242'), ('BR-251'), ('BR-259'),
    ('BR-262'), ('BR-265'), ('BR-267'), ('BR-272'), ('BR-277'), ('BR-280'), ('BR-282'), ('BR-283'),
    ('BR-285'), ('BR-287'), ('BR-290'), ('BR-293'), ('BR-304'), ('BR-307'), ('BR-308'), ('BR-316'), 
    ('BR-317'), ('BR-319'), ('BR-324'), ('BR-330'), ('BR-342'), ('BR-343'), ('BR-349'), ('BR-352'), 
    ('BR-354'), ('BR-359'), ('BR-361'), ('BR-363'), ('BR-365'), ('BR-367'), ('BR-369'), ('BR-373'), 
    ('BR-374'), ('BR-376'), ('BR-377'), ('BR-381'), ('BR-383'), ('BR-386'), ('BR-392'), ('BR-392'), 
    ('BR-401'), ('BR-402'), ('BR-403'), ('BR-404'), ('BR-405'), ('BR-406'), ('BR-407'), ('BR-408'), 
    ('BR-409'), ('BR-410'), ('BR-411'), ('BR-412'), ('BR-413'), ('BR-414'), ('BR-415'), ('BR-416');

	INSERT INTO TBL_PEDAGIO (ID_VIA)
	VALUES
	(1),  (2),  (3),  (4),  (5),  (6),  (7),  (8),  (9),  (10), (11), (12), (13), (14), (15), (16), (17), (18),	(19), 
	(20), (21), (22), (23), (24), (25), (26), (27), (28), (29), (30), (31), (32), (33), (34), (35), (36), (37),	(38), 
	(39), (40), (41), (42), (43), (44), (45), (46), (47), (48), (49), (50), (51), (52), (53), (54), (55), (56), (57);

	INSERT INTO TBL_VALOR_PEDAGIO (ID_PEDAGIO, ID_TIPO_VEICULO, VALOR_PEDAGIO)
	VALUES
	(1,1,50.0), (1,2,51.0), (1,3,52.0), (1,4,53.0), (1,5,54.0), (1,6,55.0), (1,7,56.0), (1,8,57.0),
	(2,1,60.0), (2,2,61.0), (2,3,62.0), (2,4,63.0), (2,5,64.0), (2,6,65.0), (2,7,66.0), (2,8,67.0),
	(3,1,40.0), (3,2,41.0), (3,3,42.0), (3,4,43.0), (3,5,44.0), (3,6,45.0), (3,7,46.0), (3,8,47.0),
	(4,1,70.0), (4,2,71.0), (4,3,72.0), (4,4,73.0), (4,5,74.0), (4,6,75.0), (4,7,76.0), (4,8,77.0),
	(5,1,80.0), (5,2,81.0), (5,3,82.0), (5,4,83.0), (5,5,84.0), (5,6,85.0), (5,7,86.0), (5,8,87.0),
	(6,1,90.0), (6,2,91.0), (6,3,92.0), (6,4,93.0), (6,5,94.0), (6,6,95.0), (6,7,96.0), (6,8,97.0),
	(7,1,20.0), (7,2,21.0), (7,3,22.0), (7,4,23.0), (7,5,24.0), (7,6,25.0), (7,7,26.0), (7,8,27.0),
	(8,1,30.0), (8,2,31.0), (8,3,32.0), (8,4,33.0), (8,5,34.0), (8,6,35.0), (8,7,36.0), (8,8,37.0),
	(9,1,10.0), (9,2,11.0), (9,3,12.0), (9,4,13.0), (9,5,14.0), (9,6,15.0), (9,7,16.0), (9,8,17.0),
	(10,1,50.0), (10,2,51.0), (10,3,52.0), (10,4,53.0), (10,5,54.0), (10,6,55.0), (10,7,56.0), (10,8,57.0),
	(11,1,60.0), (11,2,61.0), (11,3,62.0), (11,4,63.0), (11,5,64.0), (11,6,65.0), (11,7,66.0), (11,8,67.0),
	(12,1,70.0), (12,2,71.0), (12,3,72.0), (12,4,73.0), (12,5,74.0), (12,6,75.0), (12,7,76.0), (12,8,77.0),
	(13,1,80.0), (13,2,81.0), (13,3,82.0), (13,4,83.0), (13,5,84.0), (13,6,85.0), (13,7,86.0), (13,8,87.0),
	(14,1,40.0), (14,2,41.0), (14,3,42.0), (14,4,43.0), (14,5,44.0), (14,6,45.0), (14,7,46.0), (14,8,47.0),
	(15,1,30.0), (15,2,31.0), (15,3,32.0), (15,4,33.0), (15,5,34.0), (15,6,35.0), (15,7,36.0), (15,8,37.0),
	(16,1,90.0), (16,2,91.0), (16,3,92.0), (16,4,93.0), (16,5,94.0), (16,6,95.0), (16,7,96.0), (16,8,97.0);

	INSERT INTO TBL_VEICULO (MODELO, ANO_FABRICACAO, PLACA, COR, SITUACAO, CIDADE, UF, DATA_COMPRA, ID_FABRICANTE, ID_TIPO_VEICULO)
	VALUES
	('ACTROS', '2018-01-01', 'DET 3233', 'PRETO', 1, 'SÃO PAULO', 'SP', '2019-04-01',1,5),
	('ACTROS', '2018-01-01', 'DQT-9233', 'CINZA', 1, 'SÃO PAULO', 'SP', '2019-02-01',1,5),
	('ACTROS', '2018-01-01', 'DGT-2323', 'AZUL', 1, 'CAMPINAS', 'SP', '2019-01-09',1,5),	
	('ACTROS', '2017-01-01', 'DFT-5433', 'ROSA', 1, 'CAMPINAS', 'SP', '2018-08-01',1,5),
	('ACTROS', '2018-01-01', 'DPT-3923', 'ROSA', 1, 'CAMPINAS', 'SP', '2018-10-11',1,5),
	('ACTROS', '2017-01-01', 'DCT-3933', 'ROSA', 1, 'LIMEIRA', 'SP', '2017-04-01',1,5),
	('ACTROS', '2018-01-01', 'DDT-3233', 'ROXO', 1, 'SÃO PAULO', 'SP', '2018-02-12',1,5),
	('ACTROS', '2018-01-01', 'DMT-3283', 'BRANCO', 1, 'SÃO PAULO', 'SP', '2019-04-21',1,5),
	('FH 540', '2016-01-01', 'VQT-9233', 'CINZA', 1, 'SÃO PAULO', 'SP', '2019-02-01',3,5),
	('FH 540', '2016-01-01', 'VGT-2323', 'AZUL', 1, 'CAMPINAS', 'SP', '2019-01-09',3,5),	
	('FH 540', '2016-01-01', 'VFT-5433', 'ROSA', 1, 'CAMPINAS', 'SP', '2018-08-01',3,5),
	('FH 540', '2017-01-01', 'VPT-3923', 'ROSA', 1, 'CAMPINAS', 'SP', '2018-10-11',3,5),
	('FH 540', '2017-01-01', 'VCT-3933', 'ROSA', 1, 'LIMEIRA', 'SP', '2017-04-01',3,5),
	('FH 540', '2017-01-01', 'VDT-3233', 'ROXO', 1, 'SÃO PAULO', 'SP', '2018-02-12',3,5),
	('FH16', '2019-01-01', 'VMT-3283', 'BRANCO', 1, 'SÃO PAULO', 'SP', '2019-07-21',3,5),
	('FH 540', '2016-01-01', 'VPP-7777', 'CINZA', 0, 'SÃO PAULO', 'SP', '2019-02-01',3,5);

	INSERT INTO TBL_TRANSACOES (ID_VEICULO, PRECO, TIPO, DATA_TRANS)
	VALUES 
	(16,3000.0,'ALUGUEL','2019-03-01'),
	(16,3100.0,'ALUGUEL','2019-04-01'),
	(16,3160.0,'ALUGUEL','2019-05-01'),
	(16,3090.0,'ALUGUEL','2019-06-01'),
	(16,2900.0,'ALUGUEL','2019-07-01'),
	(16,813000.0,'VENDA','2019-08-15');
	
	INSERT INTO TBL_OFICINA (ID, NOME,CNPJ,ENDERECO, TELEFONE)
	VALUES
	(1, 'OFICINA ZEZINHO', '23.123.123/0001-23','RUA DAS ANDORINHAS, 1023, BAIRRO BAIRRO, SÃO PAULO, SP', '+55 (11)2393-9323'),
	(2, 'OFICINA BETINHO', '23.223.123/0001-13','RUA DAS POMBAS, 1033, BAIRRO PASSARO, SÃO PAULO, SP', '+55 (11)23213-9323'),
	(3, 'OFICINA TONINHO', '23.932.123/0001-32','RUA DAS ANDORINHAS, 832, BAIRRO LAGARTO, SÃO PAULO, SP', '+55 (11)9231-2932'),
	(4, 'OFICINA JOÃOZINHO', '23.743.123/0001-92','RUA DAS GALINHAS, 92, BAIRRO ELEFANTE, SÃO PAULO, SP', '+55 (11)8323-9323'),
	(5, 'OFICINA PEDRINHO', '23.892.123/0001-33','RUA DOS PAPAGAIOS, 129, BAIRRO CANGURU, SÃO PAULO, SP', '+55 (11)6723-9323'),
	(6, 'OFICINA ROMARINHO', '23.192.123/0001-23','RUA DOS PICAPAUS, 93, BAIRRO ONÇA, SÃO PAULO, SP', '+55 (11)3238-9323'),
	(7, 'OFICINA RIVALDINHO', '23.912.123/0001-23','RUA DOS GALOS, 923, BAIRRO LEÃO, SÃO PAULO, SP', '+55 (11)8323-9323'),
	(8, 'OFICINA ZEZINHO', '23.123.123/0001-23','RUA DAS ANDORINHAS, 1023, BAIRRO BAIRRO, SÃO PAULO, SP', '+55 (11)2393-9323');

	INSERT INTO TBL_MANUTENCAO (DESCRICAO, PRECO, ID_VEICULO, ID_OFICINA)
	VALUES
	('TROCA PNEU', 100.00, 1, 1),
	('TROCA OLEO', 20.00, 1, 2),
	('TROCA PNEU', 110.00, 2, 1),
	('TROCA OLEO', 250.00, 2, 3),
	('TROCA PNEU', 110.00, 4, 3),
	('TROCA PNEU', 100.00, 3, 4),
	('TROCA PNEU', 110.00, 5, 5),
	('TROCA PNEU', 110.00, 6, 2),
	('TROCA PNEU', 110.00, 10, 7);

	INSERT INTO TBL_MECANICO (NOME, CPF, DATA_NASC, LOGRADOURO, COMPLEMENTO, CEP, CIDADE, UF, ID_OFICINA)
	VALUES
	('ZEZINHO', '392.231.283-92', '1993-02-21', 'RUA DAS ANDORINHAS','PROX A ALGO', '03233-923', 'SÃO PAULO', 'SP', 1),
	('BETINHO', '392.823.283-92', '1992-11-21', 'RUA DAS POMBAS','PROX A ALGO', '92323-923', 'SÃO PAULO', 'SP', 1),
	('RONALDINHO', '392.821.283-92', '1983-10-12', 'RUA DAS ABELHAS','PROX A ALGO', '82323-923', 'SÃO PAULO', 'SP', 1),
	('EVERSONZINHO', '392.834.283-92', '1973-08-22', 'RUA DAS GALINHAS','PROX A ALGO', '83243-923', 'SÃO PAULO', 'SP', 2),
	('ROMARINHO', '392.231.734-92', '1990-03-14', 'RUA DOS PAPAGAIOS','PROX A ALGO', '82321-923', 'SÃO PAULO', 'SP', 2),
	('TONINHO', '392.823.283-92', '1980-12-29', 'RUA DOS MORCEGOS','PROX A ALGO', '71283-923', 'SÃO PAULO', 'SP', 2),
	('JOÃOZINHO', '392.732.283-92', '1970-05-28', 'RUA DOS ELEFANTES','PROX A ALGO', '76321-923', 'SÃO PAULO', 'SP', 3),
	('PEDRINHO', '392.623.283-92', '1979-06-29', 'RUA DAS BARATAS','PROX A ALGO', '01923-923', 'SÃO PAULO', 'SP', 3);
	
	INSERT INTO TBL_FUNCIONARIO (NOME, CPF, DATA_NASC, LOGRADOURO, COMPLEMENTO, CEP, CIDADE, UF, ID_CARGO)
	VALUES
	('ZEZINHO', '392.231.283-92', '1993-02-21', 'RUA DAS ANDORINHAS','PROX A ALGO', '03233-923', 'SÃO PAULO', 'SP', 1),
	('BETINHO', '392.823.283-92', '1992-11-21', 'RUA DAS POMBAS','PROX A ALGO', '92323-923', 'SÃO PAULO', 'SP', 1),
	('RONALDINHO', '392.821.283-92', '1983-10-12', 'RUA DAS ABELHAS','PROX A ALGO', '82323-923', 'SÃO PAULO', 'SP', 1),
	('EVERSONZINHO', '392.834.283-92', '1973-08-22', 'RUA DAS GALINHAS','PROX A ALGO', '83243-923', 'SÃO PAULO', 'SP', 2),
	('ROMARINHO', '392.231.734-92', '1990-03-14', 'RUA DOS PAPAGAIOS','PROX A ALGO', '82321-923', 'SÃO PAULO', 'SP', 2),
	('TONINHO', '392.823.283-92', '1980-12-29', 'RUA DOS MORCEGOS','PROX A ALGO', '71283-923', 'SÃO PAULO', 'SP', 2),
	('JOÃOZINHO', '392.732.283-92', '1970-05-28', 'RUA DOS ELEFANTES','PROX A ALGO', '76321-923', 'SÃO PAULO', 'SP', 2),
	('PEDRINHO', '392.623.283-92', '1979-06-29', 'RUA DAS BARATAS','PROX A ALGO', '01923-923', 'SÃO PAULO', 'SP', 2);

	INSERT INTO TBL_FICHA_MEDICA 
	(DEFICIENCIA, DESCRICAO_DEFICIENCIA,DOENCAS_CONTAGIOSAS_A,
	DESCRICAO_DOENCAS_CONTAGIOSAS_A,TIPO_SANGUINEO, MEDICACAO_CONTROLADA,DESCRICAO_MEDICACAO_CONTROLADA,
	ID_FUNCIONARIO) VALUES
	(0, NULL, 0, NULL, 'A+', 1, 'REMEDIOS PARA HIPERTENSÃO', 1),
	(0, NULL, 0, NULL, 'A-', 1, 'REMEDIOS PARA HIPERTENSÃO', 3),
	(0, NULL, 0, NULL, 'O+', 0, NULL, 2),
	(0, NULL, 0, NULL, 'AB-', 1, 'REMEDIOS PARA DIABETES', 4),
	(0, NULL, 0, NULL, 'B+', 0, NULL, 5),
	(0, NULL, 0, NULL, 'A+', 1, 'REMEDIOS PARA HIPERTENSÃO', 6),
	(0, NULL, 0, NULL, 'O-', 0, NULL, 7);


	INSERT INTO TBL_VIAGEM (DATA_SAIDA, DATA_CHEGADA, LOCAL_SAIDA, LOCAL_CHEGADA, DISTANCIA, FRETE, ID_VEICULO, ID_CLIENTE, ID_SUPERVISOR)
	VALUES
	('2019-08-10', NULL, 'RUA DAS SAIDAS', 'RUA DAS CHEGADAS', '987 Km', 830.30, 1, 1, 2),	
	('2019-08-19', NULL, 'RUA DAS SAIDAS2', 'RUA DAS CHEGADAS2', '897 Km', 930.30, 2, 2, 1),
	('2019-08-20', NULL, 'RUA DAS SAIDAS3', 'RUA DAS CHEGADAS3', '798 Km', 530.30, 3, 3, 1),
	('2019-08-22', NULL, 'RUA DAS SAIDAS4', 'RUA DAS CHEGADAS4', '887 Km', 630.30, 4, 1, 2),
	('2019-08-26', NULL, 'RUA DAS SAIDAS5', 'RUA DAS CHEGADAS5', '997 Km', 230.30, 5, 3, 3),
	('2019-09-01', NULL, 'RUA DAS SAIDAS6', 'RUA DAS CHEGADAS6', '1207 Km', 730.30, 1, 2, 3),
	('2019-09-10', NULL, 'RUA DAS SAIDAS7', 'RUA DAS CHEGADAS7', '865 Km', 230.30, 2, 1, 3);

	INSERT INTO TBL_MOTORISTA_VIAGEM (ID_FUNCIONARIO, ID_VIAGEM)
	VALUES
	(5,1), (4,1), 
	(6,2), (7,2), 
	(4,3), (8,3), 
	(5,4), (7,4), 
	(4,5), (5,5), 
	(6,6), (7,6), 
	(8,7), (4,7);

	INSERT INTO TBL_DIARIO_BORDO (TBL_VIAGEM_ID, DESCRICAO, PRECO, DATA_INICIO, DATA_FIM, ID_MOTORISTA_ATUAL)
	VALUES
	(1, 'ALIMENTAÇÃO', 30.50, '2019-08-12 00:00:00', '2019-08-12 00:00:00', 4),
	(1, 'TROCA DE MOTORISTA', 0.0, '2019-08-12 00:00:00', '2019-08-12 00:00:00', 4),	
	(1, 'ALIMENTAÇÃO', 36.50, '2019-08-12 00:00:00', '2019-08-12 00:00:00', 5),
	(1, 'PAUSA PARA DESCANÇO', 0, '2019-08-13 00:00:00', '2019-08-13 00:00:00', 5),	
	(1, 'TROCA DE MOTORISTA', 0, '2019-08-13 00:00:00', '2019-08-13 00:00:00', 5),	
	(2, 'ALIMENTAÇÃO', 31.50, '2019-08-19 00:00:00', '2019-08-19 00:00:00', 6),
	(2, 'TROCA DE MOTORISTA', 0.0, '2019-08-19 00:00:00', '2019-08-19 00:00:00', 6),	
	(2, 'ALIMENTAÇÃO', 33.50, '2019-08-19 00:00:00', '2019-08-19 00:00:00', 7),
	(2, 'PAUSA PARA DESCANÇO', 0, '2019-08-19 00:00:00', '2019-08-20 00:00:00', 7),	
	(2, 'TROCA DE MOTORISTA', 0, '2019-08-20 00:00:00', '2019-08-20 00:00:00', 7),	
	(3, 'ALIMENTAÇÃO', 34.50, '2019-08-20 00:00:00.000', '2019-08-20 00:00:00.000', 8),
	(3, 'TROCA DE MOTORISTA', 0.0, '2019-08-20 00:00:00.000', '2019-08-20 00:00:00.000', 8),	
	(3, 'ALIMENTAÇÃO', 31.50, '2019-08-21 00:00:00.000', '2019-08-21 00:00:00.000', 4),
	(3, 'PAUSA PARA DESCANÇO', 0, '2019-08-21 00:00:00.000', '2019-08-22 00:00:00.000', 4),	
	(3, 'TROCA DE MOTORISTA', 0, '2019-08-22 00:00:00.000', '2019-08-22 00:00:00', 4);

	INSERT INTO TBL_TRAJETO (ID_VIAGEM, ID_VIA)
	VALUES
	(1, 1), (1, 2), (1, 10), (1, 20), (1, 30), (1, 23), (1, 26),
	(2, 1), (2, 2), (2, 10), (2, 20), (2, 30), (2, 23), (2, 26),
	(3, 1), (3, 2), (3, 10), (3, 20), (3, 30), (3, 23), (3, 26),
	(4, 1), (4, 2), (4, 10), (4, 20), (4, 30), (4, 23), (4, 26);

	INSERT INTO TBL_MERCADORIA (DESCRICAO, QTD, ID_TIPO_MERCADORIA, ID_VIAGEM)
	VALUES
	('AÇO', 12000, 1, 1), ('MADEIRA', 15000, 1, 2), ('SOJA', 7000, 2, 3), ('MILHO', 9000, 2, 4),
	('CARNE', 4000, 4, 5), ('LINGUIÇA', 9000, 4, 6), ('COMBUSTIVEL', 9000, 5, 7);

--1 Quantos funcionários estão em cada cargo?

SELECT COUNT(FUNC.NOME) as Funcionários,
	   CARGO.DESCRICAO as Cargo
FROM   dbo.TBL_FUNCIONARIO FUNC
INNER JOIN dbo.TBL_CARGO CARGO
ON FUNC.ID_CARGO = CARGO.ID
GROUP BY CARGO.DESCRICAO

--2 Quantos funcionários estão em SP?

SELECT COUNT(NOME) as Funcionários
FROM dbo.TBL_FUNCIONARIO
WHERE UF = 'SP'

--3 Quantos clientes a empresa possui?

SELECT DISTINCT COUNT(ID)
FROM dbo.TBL_CLIENTE

--4 Quanto custou o frete até o momento?

SELECT SUM(V.FRETE) AS Custo
FROM dbo.TBL_VIAGEM V

--5 Quanto custou o pedágio em cada uma das viagens feitas até agora?

SELECT T.ID_VIAGEM,
	   SUM(VL.VALOR_PEDAGIO) AS CUSTO
FROM   TBL_TRAJETO T
INNER JOIN TBL_PEDAGIO P 
ON T.ID_VIA = P.ID_VIA
INNER JOIN TBL_VALOR_PEDAGIO VL
ON VL.ID_PEDAGIO = P.ID_PEDAGIO
INNER JOIN TBL_VEICULO V
ON V.ID_TIPO_VEICULO=VL.ID_TIPO_VEICULO
GROUP BY T.ID_VIAGEM

--6 Quantas viagens foram feitas por motorista (viagens agrupadas pelo nome do motorista)?

SELECT CONCAT(UPPER(SUBSTRING(FUNC.NOME,1,1)),LOWER(SUBSTRING(FUNC.NOME,2,LEN(FUNC.NOME)))) AS MOTORISTA,
	   COUNT(MV.ID_VIAGEM) AS VIAGENS
FROM TBL_MOTORISTA_VIAGEM MV
INNER JOIN TBL_FUNCIONARIO FUNC
ON FUNC.ID = MV.ID_FUNCIONARIO
GROUP BY FUNC.NOME

--7 Há quantos dias cada carro está na empresa?
SELECT V.PLACA,
	   V.DATA_COMPRA,
	   DATEDIFF(day,V.DATA_COMPRA,GETDATE()) AS DIAS_NA_EMPRESA
FROM TBL_VEICULO V

--8 O motorista Betinho toma medicação controlada?
SELECT FM.MEDICACAO_CONTROLADA,
	   FM.DESCRICAO_MEDICACAO_CONTROLADA
FROM TBL_FICHA_MEDICA FM
WHERE FM.ID_FUNCIONARIO = (SELECT ID
							FROM TBL_FUNCIONARIO
							WHERE NOME ='BETINHO')

--9 Quanto é o frete médio das viagens da empresa?
SELECT AVG(V.FRETE) FRETE_MEDIO
FROM TBL_VIAGEM V

--10 Quantos mecânicos trabalham em cada oficina que presta serviços para a empresa?
SELECT O.NOME,
		COUNT(M.NOME)
FROM TBL_OFICINA O
LEFT JOIN TBL_MECANICO M
ON O.ID = M.ID_OFICINA
GROUP BY O.NOME


